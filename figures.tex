
\def\mnistAnimated#1{
\resizebox{\linewidth}{!}{
\begin{tikzpicture}
\node[inner sep=0pt] (pic) at (28px,28px) {\includegraphics[width = 56px]{#1}};
\draw[lightgray,thin] (0,0) rectangle (56px,56px);
\onslide<2->{\draw[step=2px,lightgray,ultra thin] (0,0) grid (56px,56px);}
\end{tikzpicture}}
}

\def\mnist#1{
\resizebox{\linewidth}{!}{
\begin{tikzpicture}
\node[inner sep=0pt] (pic) at (28px,28px) {\includegraphics[width = 56px]{#1}};
\draw[lightgray,thin] (0,0) rectangle (56px,56px);
\draw[step=2px,lightgray,ultra thin] (0,0) grid (56px,56px);
\end{tikzpicture}}
}

\def\neuralnetworkAnimated{
\begin{tikzpicture}[bc/.default={lgray}]
\onslide<3->{
\foreach \i in {0,...,9}
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black, label = {right:\i}] (o\i) at (12,-0.5*\i-1.75) {};
}
\onslide<4->{
\foreach \i in {0,...,15}{
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black] (h\i) at (8,-0.5*\i-0.25) {};
    \onslide<5->{
    \foreach \j in {0,...,9}
        \draw[ultra thin] (h\i) -- (o\j);}
}
\foreach \i in {0,...,15}{
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black] (i\i) at (4,-0.5*\i-0.25) {};
    \onslide<5->{
    \foreach \j in {0,...,15}
        \draw[ultra thin] (i\i) -- (h\j);}
}
}
\onslide<2->{
\foreach \i in {0,...,7}{
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black] (x\i) at (0,-0.5*\i) {};
        \onslide<5->{
        \foreach \j in {0,...,15}
        \draw[ultra thin] (x\i) -- (i\j);}
}
\node[ fill = none, draw=none] (x8) at (0,-0.5*8) {$\vdots$};
\foreach \i in {9,...,16}{
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black] (x\i) at (0,-0.5*\i) {};
    \onslide<5->{
    \foreach \j in {0,...,15}
        \draw[ultra thin] (x\i) -- (i\j);}
}
\draw[decoration={brace,raise=20pt},decorate] (x16) -- node[left=20pt] {784} (x0);
}
\end{tikzpicture}
}

\def\neuralnetwork{
\begin{tikzpicture}[bc/.default={lgray}]

\foreach \i in {0,...,2}{
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black,] (y\i) at (13,-0.5*\i-1.75) {};
}
\node[bc, text width = 0.1, fill = black, draw=btdl@color@black,] (y3) at (13,-0.5*3-1.75) {};
\foreach \i in {4,...,9}{
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black,] (y\i) at (13,-0.5*\i-1.75) {};
}
\foreach \i in {0,...,9}{
    \pgfmathparse{rnd}
    \definecolor{rndgray}{gray}{\pgfmathresult}
    \node[bc, text width = 0.1, fill = rndgray, draw=btdl@color@black, label = {right:\i}] (o\i) at (12,-0.5*\i-1.75) {};
}
\foreach \i in {0,...,15}{
    \pgfmathparse{rnd}
    \definecolor{rndgray}{gray}{\pgfmathresult}
    \node[bc, text width = 0.1, fill = rndgray, draw=btdl@color@black] (h\i) at (8,-0.5*\i-0.25) {};
    \foreach \j in {0,...,9}
        \draw[ultra thin] (h\i) -- (o\j);
}
\foreach \i in {0,...,15}{
    \pgfmathparse{rnd}
    \definecolor{rndgray}{gray}{\pgfmathresult}
    \node[bc, text width = 0.1, fill = rndgray, draw=btdl@color@black] (i\i) at (4,-0.5*\i-0.25) {};
    \foreach \j in {0,...,15}
        \draw[ultra thin] (i\i) -- (h\j);
}
\foreach \i in {0,...,7}{
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black] (x\i) at (0,-0.5*\i) {};
        \foreach \j in {0,...,15}
        \draw[ultra thin] (x\i) -- (i\j);
}
\node[ fill = none, draw=none] (x8) at (0,-0.5*8) {$\vdots$};
\foreach \i in {9,...,16}{
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black] (x\i) at (0,-0.5*\i) {};
    \foreach \j in {0,...,15}
        \draw[ultra thin] (x\i) -- (i\j);
}
\draw[decoration={brace,raise=20pt},decorate] (x16) -- node[left=20pt] {784} (x0);
\end{tikzpicture}
}

\def\neuralnetworkCost{
\pgfkeys{/pgf/number format/.cd,
    fixed,
    fixed zerofill,
    precision=2,
    set thousands separator={}}

\begin{tikzpicture}[bc/.default={lgray}]

\foreach \i in {0,...,2}{
    \node[circle, fill = none, draw=btdl@color@black, label = {right:$\biggl)^2$}] (y\i) at (6,-1.5*\i) {$\pgfmathprintnumber{0.00}$};
}
\node[circle,  fill = none, draw=btdl@color@black, label = {right:$\biggl)^2$}] (y3) at (6,-1.5*3) {$\pgfmathprintnumber{1.00}$};
\foreach \i in {4,...,9}{
    \node[circle, fill = none, draw=btdl@color@black, label = {right:$\biggl)^2$}] (y\i) at (6,-1.5*\i) {$\pgfmathprintnumber{0.00}$};
}
\foreach \i in {0,...,9}{
    \node[circle, fill = none, draw=btdl@color@black, label = {left:$\biggl($}, label = {right:\i}] (o\i) at (0,-1.5*\i) {\pgfmathparse{rnd}$\pgfmathprintnumber{\pgfmathresult}$};
    \node (n\i) at (3,-1.5*\i) {$-$};
}
\draw[decoration={brace,raise=60pt},decorate] (o9) -- node[left=80pt] {
\Huge $C\begin{pmatrix}
        \includegraphics[width = 56px]{Mnist3-a.png}
        \end{pmatrix}
        =$ Summe
} (o0);
\end{tikzpicture}
}

\def\neuralnetworkSingleNeuron{
\begin{tikzpicture}[bc/.default={lgray}]
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black] (i0) at (4,-0.5*8) {};

\foreach \i in {0,...,7}{
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black, label = {right:$a_\i$}] (x\i) at (0,-0.5*\i) {};
    \draw[ultra thin] (x\i) -- (i0);
    \node (w\i) at (2,-0.5*\i) {$w_\i$};
}
\node[fill = none, draw=none, label = {right:$a_n$}] (x8) at (0,-0.5*8) {$\vdots$};
\node (wn) at (2,-0.5*8) {$w_n$};
\foreach \i in {9,...,16}{
    \node[bc, text width = 0.1, fill = none, draw=btdl@color@black] (x\i) at (0,-0.5*\i) {};
    \draw[ultra thin] (x\i) -- (i0);
}
\draw[decoration={brace,raise=20pt},decorate] (x16) -- node[left=20pt] {784} (x0);
\end{tikzpicture}
}

\def\neuralnetworkMatrix{
\begin{tikzpicture}[bc/.default={lgray}]

\node[circle, fill = none, draw=btdl@color@black] (i0) at (6,-1.5*0-1.5) {$a_{0}^{(1)}$};

\foreach \i in {0,...,7}{
    \node[circle, fill = none, draw=btdl@color@black] (x\i) at (0,-1.5*\i) {$a_{\i}^{(0)}$};
        \draw[ultra thin] (x\i) -- (i0);
}
\onslide<2->{
\foreach \i in {1,...,5}{
    \node[circle, fill = none, draw=btdl@color@black] (i\i) at (6,-1.5*\i-1.5) {$a_{\i}^{(1)}$};
}
\foreach \i in {0,...,7}{
    \node[circle, fill = none, draw=btdl@color@black] (x\i) at (0,-1.5*\i) {$a_{\i}^{(0)}$};
        \foreach \j in {1,...,5}
        \draw[ultra thin] (x\i) -- (i\j);
}
}
\end{tikzpicture}
}

\def\perceptron{
\begin{tikzpicture}[bc/.default={lgray}]
    \node[] (x0) at (-4,2) {$x_0$};
    \node[] (x1) at (-4,1) {$x_1$};
    \node[] (x2) at (-4,0) {$x_2$};
    \node[] (x...) at (-4,-1) {...};
    \node[] (xn) at (-4,-2) {$x_n$};
    \node[above=.75cm, text width=8em, align=center] at (x0) {Inputvektor $\vec{x}$};

    \node[bc, rectangle, minimum size=1cm] (ueber) at (0,0) {$\sum$};
    \node[below=.75cm, text width=8em, align=center] at (ueber) {Übertragungsfunktion};


    \draw[ctarrow=lgray] (x0) -- (ueber) node[text=darkgray,midway] {$ w_{0 }$};
    \draw[ctarrow=lgray] (x1) -- (ueber) node[text=darkgray,midway] {$ w_{1 }$};
    \draw[ctarrow=lgray] (x2) -- (ueber) node[text=darkgray,midway] {$ w_{2 }$};
    \draw[ctarrow=lgray] (xn) -- (ueber) node[text=darkgray,midway] {$ w_{n }$};

    \node[bc, rectangle, minimum size=1cm] (aktiv) at (4,0) {$\varphi$};
    \node[below=.75cm, text width=8em, align=center] at (aktiv) {Aktivierungsfunktion};

    \draw[tarrow=lgray] (ueber) -- (aktiv) node[text=darkgray,midway] (net) {$net$};
    \node[above=.75cm, text width=8em, align=center] at (net) {Netzeingabe};

    \node[] (out) at (6,0) {$o$};
    \node[above=.75cm, text width=8em, align=center] at (out) {Output};
    \draw[tarrow=lgray] (aktiv) -- (out);
\end{tikzpicture}}

\def\perceptronFirstHalf{
\begin{tikzpicture}[bc/.default={lgray}]
    \node[] (x0) at (-4,2) {$x_0$};
    \node[] (x1) at (-4,1) {$x_1$};
    \node[] (x2) at (-4,0) {$x_2$};
    \node[] (x...) at (-4,-1) {...};
    \node[] (xn) at (-4,-2) {$x_n$};
    \node[above=.75cm, text width=8em, align=center] at (x0) {Inputvektor $\vec{x}$};

    \node[bc, rectangle, minimum size=1cm] (ueber) at (0,0) {$\sum$};
    \node[below=.75cm, text width=8em, align=center] at (ueber) {Übertragungsfunktion};


    \draw[ctarrow=lgray] (x0) -- (ueber) node[text=darkgray,midway] {$ w_{0 }$};
    \draw[ctarrow=lgray] (x1) -- (ueber) node[text=darkgray,midway] {$ w_{1 }$};
    \draw[ctarrow=lgray] (x2) -- (ueber) node[text=darkgray,midway] {$ w_{2 }$};
    \draw[ctarrow=lgray] (xn) -- (ueber) node[text=darkgray,midway] {$ w_{n }$};


    \draw[tarrow=lgray] (ueber) -- (2,0) node[text=darkgray,midway] (net) {$net$};
    \node[above=.75cm, text width=8em, align=center] at (net) {Netzeingabe};
\end{tikzpicture}}

\def\perceptronSecondHalf{
\begin{tikzpicture}[bc/.default={lgray}]
    \node[bc, rectangle, minimum size=1cm] (aktiv) at (4,0) {$\varphi$};
    \node[below=.75cm, text width=8em, align=center] at (aktiv) {Aktivierungsfunktion};

    \draw[tarrow=lgray] (2,0) -- (aktiv) node[text=darkgray,midway] (net) {$net$};
    \node[above=.75cm, text width=8em, align=center] at (net) {Netzeingabe};

    \node[] (out) at (6,0) {$o$};
    \node[above=.75cm, text width=8em, align=center] at (out) {Output};
    \draw[tarrow=lgray] (aktiv) -- (out);
\end{tikzpicture}}

\def\feedforwardNetwork{
\begin{tikzpicture}[bc/.default={lgray}]
    \node[bc] (x0) at (-4,1) {$x_0$};
    \node[bc] (x1) at (-4,0) {$x_1$};
    \node[bc] (x2) at (-4,-1) {$x_2$};

    \node[bc, fill=btdl@color@secondary] (neuro0) at (0,1) {};
    \node[bc, fill=btdl@color@secondary] (neuro1) at (0,0) {};
    \node[bc, fill=btdl@color@secondary] (neuro2) at (0,-1) {};
    \node[below=.75cm, text width=8em, align=center] at (neuro2) {Ausgabeschicht};

    \draw[tarrow=lgray] (x0) -- (neuro0);
    \draw[tarrow=lgray] (x0) -- (neuro1);
    \draw[tarrow=lgray] (x0) -- (neuro2);

    \draw[tarrow=lgray] (x1) -- (neuro0);
    \draw[tarrow=lgray] (x1) -- (neuro1);
    \draw[tarrow=lgray] (x1) -- (neuro2);

    \draw[tarrow=lgray] (x2) -- (neuro0);
    \draw[tarrow=lgray] (x2) -- (neuro1);
    \draw[tarrow=lgray] (x2) -- (neuro2);

    \node[] (o0) at (2,1) {};
    \node[] (o1) at (2,0) {};
    \node[] (o2) at (2,-1) {};

    \draw[tarrow=lgray] (neuro0) -- (o0);
    \draw[tarrow=lgray] (neuro1) -- (o1);
    \draw[tarrow=lgray] (neuro2) -- (o2);

\end{tikzpicture}}

\def\deepfeedforwardNetwork{
\begin{tikzpicture}[bc/.default={lgray}]
    \node[bc] (x0) at (-4,1) {$x_0$};
    \node[bc] (x1) at (-4,0) {$x_1$};
    \node[bc] (x2) at (-4,-1) {$x_2$};

    \node[bc, fill=btdl@color@primary] (neuro00) at (0,1) {};
    \node[bc, fill=btdl@color@primary] (neuro10) at (0,0) {};
    \node[bc, fill=btdl@color@primary] (neuro20) at (0,-1) {};
    \node[below=.75cm, text width=10em, align=center] at (neuro20) {verborgene Schicht};

    \draw[tarrow=lgray] (x0) -- (neuro00);
    \draw[tarrow=lgray] (x0) -- (neuro10);
    \draw[tarrow=lgray] (x0) -- (neuro20);

    \draw[tarrow=lgray] (x1) -- (neuro00);
    \draw[tarrow=lgray] (x1) -- (neuro10);
    \draw[tarrow=lgray] (x1) -- (neuro20);

    \draw[tarrow=lgray] (x2) -- (neuro00);
    \draw[tarrow=lgray] (x2) -- (neuro10);
    \draw[tarrow=lgray] (x2) -- (neuro20);

    \node[bc, fill=btdl@color@secondary] (neuro01) at (4,0.5) {};
    \node[bc, fill=btdl@color@secondary] (neuro11) at (4,-0.5) {};

    \draw[tarrow=lgray] (neuro00) -- (neuro01);
    \draw[tarrow=lgray] (neuro00) -- (neuro11);

    \draw[tarrow=lgray] (neuro10) -- (neuro01);
    \draw[tarrow=lgray] (neuro10) -- (neuro11);

    \draw[tarrow=lgray] (neuro20) -- (neuro01);
    \draw[tarrow=lgray] (neuro20) -- (neuro11);

    \node[] (o0) at (6,0.5) {};
    \node[] (o1) at (6,-0.5) {};
    \node[below=.75cm, text width=8em, align=center] at (neuro11) {Ausgabeschicht};


    \draw[tarrow=lgray] (neuro01) -- (o0);
    \draw[tarrow=lgray] (neuro11) -- (o1);

\end{tikzpicture}}

\def\recursiveNetwork{
\begin{tikzpicture}[bc/.default={lgray}]
    \node[bc] (x0) at (-4,1.5) {$x_0$};
    \node[bc] (x1) at (-4,0.5) {$x_1$};
    \node[bc] (x2) at (-4,-0.5) {$x_2$};
    \node[bc] (x3) at (-4,-1.5) {$x_3$};

    \node[bc, fill=btdl@color@secondary] (neuro00) at (0,1.5) {};
    \node[bc, fill=btdl@color@secondary] (neuro10) at (0,0) {};
    \node[bc, fill=btdl@color@secondary] (neuro20) at (0,-1.5) {};
    \node[below=.75cm, text width=8em, align=center] at (neuro20) {Ausgabeschicht};

    \draw[tarrow=lgray] (x0) -- (neuro00);
    \draw[tarrow=lgray] (x0) -- (neuro10);
    \draw[tarrow=lgray] (x0) -- (neuro20);

    \draw[tarrow=lgray] (x1) -- (neuro00);
    \draw[tarrow=lgray] (x1) -- (neuro10);
    \draw[tarrow=lgray] (x1) -- (neuro20);

    \draw[tarrow=lgray] (x2) -- (neuro00);
    \draw[tarrow=lgray] (x2) -- (neuro10);
    \draw[tarrow=lgray] (x2) -- (neuro20);

    \draw[tarrow=lgray] (x2) -- (neuro00);
    \draw[tarrow=lgray] (x2) -- (neuro10);
    \draw[tarrow=lgray] (x2) -- (neuro20);

    \draw[tarrow=lgray] (x3) -- (neuro00);
    \draw[tarrow=lgray] (x3) -- (neuro10);
    \draw[tarrow=lgray] (x3) -- (neuro20);

    \node[] (o0) at (2,1.5) {};
    \node[] (o1) at (2,0) {};
    \node[] (o2) at (2,-1.5) {};

    \draw[tarrow=lgray] (neuro00) -- (o0);
    \draw[tarrow=lgray] (neuro00.east) .. controls +(right:1) and +(up:1) .. (neuro00.north);

    \draw[tarrow=lgray] (neuro10) -- (o1);
    \draw[tarrow=lgray] (neuro10.east) .. controls +(right:1) and +(up:1) .. (neuro10.north);

    \draw[tarrow=lgray] (neuro20) -- (o2);
    \draw[tarrow=lgray] (neuro20.east) .. controls +(right:1) and +(up:1) .. (neuro20.north);

\end{tikzpicture}}
